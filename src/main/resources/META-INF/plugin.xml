<!-- Plugin Configuration File: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <!-- Unique identifier of the plugin -->
    <id>com.zime.app.android-to-flutter</id>

    <!-- Public plugin name -->
    <name>Android to Flutter Porter</name>

    <!-- Vendor information -->
    <vendor email="support@example.com" url="https://github.com/example/android-to-flutter">
        Android to Flutter Team
    </vendor>

    <!-- Plugin description -->
    <description><![CDATA[
        <h2>Android to Flutter Porter</h2>
        <p>Android Kotlin/Jetpack Compose 앱을 Flutter로 자동 변환하는 IntelliJ IDEA 플러그인입니다.</p>
        
        <h3>주요 기능</h3>
        <ul>
            <li><b>100% UI 동일성</b>: Android 화면과 Flutter 화면을 픽셀 단위로 일치</li>
            <li><b>100% 동작 동일성</b>: 비즈니스 로직 완벽 보존</li>
            <li><b>AI 기반 변환</b>: Claude Code를 활용한 지능형 코드 변환</li>
            <li><b>스크린샷 검증</b>: 변환 결과를 시각적으로 검증</li>
        </ul>
        
        <h3>필수 요구사항</h3>
        <ul>
            <li>Claude Code Max 이상 구독 (Hook 기능)</li>
            <li>Flutter SDK 3.19+</li>
            <li>IntelliJ IDEA 2025.2+</li>
        </ul>
        
        <h3>지원 변환</h3>
        <ul>
            <li>Kotlin → Dart</li>
            <li>Jetpack Compose → Flutter Widget</li>
            <li>ViewModel → Riverpod/Provider</li>
            <li>Room → Drift</li>
            <li>Retrofit → Dio</li>
        </ul>
    ]]></description>

    <!-- Change notes -->
    <change-notes><![CDATA[
        <h3>1.0.0</h3>
        <ul>
            <li>Initial release</li>
            <li>Kotlin/Compose to Flutter conversion</li>
            <li>Claude Code integration (Hook + CLI)</li>
            <li>Screenshot-based verification</li>
        </ul>
    ]]></change-notes>

    <!-- Product and plugin compatibility requirements -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.compose</depends>
    <depends>com.intellij.java</depends>
    <depends>org.jetbrains.kotlin</depends>

    <!-- Optional dependencies -->
    <depends optional="true" config-file="optional/withDart.xml">Dart</depends>
    <depends optional="true" config-file="optional/withFlutter.xml">io.flutter</depends>
    <depends optional="true" config-file="optional/withAndroid.xml">org.jetbrains.android</depends>

    <!-- Resource bundle for localization -->
    <resource-bundle>messages.PorterBundle</resource-bundle>

    <!-- Kotlin K2 mode compatibility - This plugin uses Kotlin PSI APIs that require K1 mode -->
    <extensions defaultExtensionNs="org.jetbrains.kotlin">
        <supportsKotlinPluginMode supportsK2="false"/>
    </extensions>

    <!-- Extensions -->
    <extensions defaultExtensionNs="com.intellij">
        <!-- Tool Window -->
        <toolWindow 
            id="Android to Flutter Porter" 
            factoryClass="com.zime.app.androidtoflutter.ui.toolwindow.PorterToolWindowFactory"
            anchor="right"
            icon="AllIcons.Actions.SwapPanels"
            secondary="false"/>
        
        <!-- Project Service -->
        <projectService 
            serviceImplementation="com.zime.app.androidtoflutter.services.ConversionService"/>
        
        <!-- Notification Group -->
        <notificationGroup 
            id="Android to Flutter Porter" 
            displayType="BALLOON"/>
    </extensions>

    <!-- Actions -->
    <actions>
        <!-- Convert Actions Group -->
        <group id="AndroidToFlutter.ConvertGroup" 
               text="Android to Flutter" 
               description="Android to Flutter conversion actions"
               popup="true">
            
            <add-to-group group-id="ToolsMenu" anchor="last"/>
            
            <action id="AndroidToFlutter.ConvertFile"
                    class="com.zime.app.androidtoflutter.actions.ConvertFileAction"
                    text="Convert Current File"
                    description="Convert the current Kotlin file to Flutter/Dart"
                    icon="AllIcons.Actions.SwapPanels">
                <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt F"/>
            </action>
            
            <action id="AndroidToFlutter.ConvertProject"
                    class="com.zime.app.androidtoflutter.actions.ConvertProjectAction"
                    text="Convert Entire Project"
                    description="Convert the entire Android project to Flutter"
                    icon="AllIcons.Actions.Execute"/>
            
            <separator/>
            
            <action id="AndroidToFlutter.SetupHooks"
                    class="com.zime.app.androidtoflutter.actions.SetupHooksAction"
                    text="Setup Claude Code Hooks"
                    description="Install Claude Code hooks for AI-assisted conversion"
                    icon="AllIcons.Actions.Install"/>
            
            <action id="AndroidToFlutter.Verify"
                    class="com.zime.app.androidtoflutter.actions.VerifyAction"
                    text="Verify Conversion"
                    description="Compare screenshots to verify conversion accuracy"
                    icon="AllIcons.Actions.Checked"/>
        </group>
        
        <!-- Editor Context Menu -->
        <action id="AndroidToFlutter.ConvertSelection"
                class="com.zime.app.androidtoflutter.actions.ConvertSelectionAction"
                text="Convert to Flutter"
                description="Convert selected Compose code to Flutter"
                icon="AllIcons.Actions.SwapPanels">
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="Generate"/>
        </action>
    </actions>
</idea-plugin>
